<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HOCEA</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 30px 0;
        }
        
        .main-container {
            max-width: 900px;
            margin: 0 auto;
        }
        
        .form-card {
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
            padding: 40px;
            margin-bottom: 30px;
        }
        
        .form-header {
            text-align: center;
            margin-bottom: 30px;
            color: #667eea;
        }
        
        .form-header h1 {
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .form-header p {
            color: #6c757d;
            font-size: 1.1rem;
        }
        
        .form-label {
            font-weight: 600;
            color: #495057;
            margin-bottom: 8px;
        }
        
        .form-control, .form-select {
            border-radius: 8px;
            border: 2px solid #e0e0e0;
            padding: 10px 15px;
            transition: all 0.3s;
        }
        
        .form-control:focus, .form-select:focus {
            border-color: #667eea;
            box-shadow: 0 0 0 0.2rem rgba(102, 126, 234, 0.25);
        }
        
        .btn-submit {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            border-radius: 8px;
            padding: 12px 40px;
            font-weight: 600;
            font-size: 1.1rem;
            width: 100%;
            margin-top: 20px;
            transition: transform 0.2s;
        }
        
        .btn-submit:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
        }
        
        .summary-card {
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
            padding: 30px;
        }
        
        .summary-header {
            text-align: center;
            color: #667eea;
            margin-bottom: 25px;
        }
        
        .summary-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-box {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }
        
        .stat-box h3 {
            font-size: 2.5rem;
            font-weight: bold;
            margin: 0;
        }
        
        .stat-box p {
            margin: 5px 0 0 0;
            font-size: 0.9rem;
            opacity: 0.9;
        }
        
        .registrations-table {
            margin-top: 20px;
        }
        
        .table {
            border-radius: 10px;
            overflow: hidden;
        }
        
        .table thead {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .table tbody tr:hover {
            background-color: #f8f9fa;
        }
        
        .badge-date {
            padding: 8px 12px;
            font-size: 0.85rem;
        }
        
        .no-registrations {
            text-align: center;
            padding: 40px;
            color: #6c757d;
        }
        
        .date-options {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        
        .date-option {
            position: relative;
        }
        
        .date-option input[type="radio"] {
            position: absolute;
            opacity: 0;
        }
        
        .date-option label {
            display: block;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
            font-weight: 600;
        }
        
        .date-option input[type="radio"]:checked + label {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-color: #667eea;
        }
        
        .date-option label:hover {
            border-color: #667eea;
        }
        
        .success-message {
            display: none;
            background: #d4edda;
            color: #155724;
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
            border: 1px solid #c3e6cb;
        }
    </style>
</head>
<body>
    <div class="main-container">
        <!-- Registration Form -->
        <div class="form-card">
            <div class="form-header">
                <h1>ğŸ‰ HOCEA Event Registration</h1>
                <p>Please fill in your details to register for the event</p>
            </div>
            
            <form id="registrationForm">
                <div class="row mb-3">
                    <div class="col-md-6">
                        <label for="name" class="form-label">Name *</label>
                        <input type="text" class="form-control" id="name" required placeholder="Enter your full name">
                    </div>
                    <div class="col-md-6">
                        <label for="mobile" class="form-label">Mobile Number *</label>
                        <input type="tel" class="form-control" id="mobile" required placeholder="Enter mobile number" pattern="[0-9]{10,12}">
                    </div>
                </div>
                
                <div class="row mb-3">
                    <div class="col-md-6">
                        <label for="adults" class="form-label">Number of Adults *</label>
                        <input type="number" class="form-control" id="adults" required min="0" value="1">
                    </div>
                    <div class="col-md-6">
                        <label for="children" class="form-label">Number of Children *</label>
                        <input type="number" class="form-control" id="children" required min="0" value="0">
                    </div>
                </div>
                
                <div class="mb-3">
                    <label for="foodPreference" class="form-label">Food Preference *</label>
                    <select class="form-select" id="foodPreference" required>
                        <option value="">Select preference</option>
                        <option value="Veg">Vegetarian</option>
                        <option value="Non-Veg">Non-Vegetarian</option>
                    </select>
                </div>
                
                <div class="mb-3">
                    <label class="form-label">Proposed Date *</label>
                    <div class="date-options">
                        <div class="date-option">
                            <input type="radio" name="eventDate" id="date1" value="28-Dec-2025" required>
                            <label for="date1">ğŸ“… 28th December 2025</label>
                        </div>
                        <div class="date-option">
                            <input type="radio" name="eventDate" id="date2" value="4-Jan-2026" required>
                            <label for="date2">ğŸ“… 4th January 2026</label>
                        </div>
                    </div>
                </div>
                
                <button type="submit" class="btn btn-primary btn-submit">Register Now</button>
                
                <div class="success-message" id="successMessage">
                    âœ… Registration successful! Your details have been added to the summary below.
                </div>
            </form>
        </div>
        
        <!-- Summary Section -->
        <div class="summary-card">
            <div class="summary-header">
                <h2>ğŸ“Š Registration Summary</h2>
                <div class="mt-3">
                    <button class="btn btn-sm btn-outline-primary me-2" onclick="exportData()">ğŸ“¥ Export Data</button>
                    <button class="btn btn-sm btn-outline-success" onclick="document.getElementById('importFile').click()">ğŸ“¤ Import Data</button>
                    <input type="file" id="importFile" accept=".json" style="display: none;" onchange="importData(event)">
                </div>
            </div>
            
            <div class="summary-stats">
                <div class="stat-box">
                    <h3 id="totalRegistrations">0</h3>
                    <p>Total Registrations</p>
                </div>
                <div class="stat-box">
                    <h3 id="totalAdults">0</h3>
                    <p>Total Adults</p>
                </div>
                <div class="stat-box">
                    <h3 id="totalChildren">0</h3>
                    <p>Total Children</p>
                </div>
                <div class="stat-box">
                    <h3 id="totalPeople">0</h3>
                    <p>Total People</p>
                </div>
            </div>
            
            <div class="registrations-table">
                <h4 class="mb-3">Registration Details</h4>
                <div class="table-responsive">
                    <table class="table table-hover">
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>Name</th>
                                <th>Mobile</th>
                                <th>Adults</th>
                                <th>Children</th>
                                <th>Food</th>
                                <th>Preferred Date</th>
                            </tr>
                        </thead>
                        <tbody id="registrationsTableBody">
                            <tr>
                                <td colspan="7" class="no-registrations">
                                    No registrations yet. Be the first to register!
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            
            <div class="row mt-4">
                <div class="col-md-6">
                    <h5>Date Preferences:</h5>
                    <div class="badge bg-info text-dark me-2 mb-2 badge-date">28-Dec-2025: <strong id="date1Count">0</strong> votes</div>
                    <div class="badge bg-success text-white badge-date">4-Jan-2026: <strong id="date2Count">0</strong> votes</div>
                </div>
                <div class="col-md-6">
                    <h5>Food Preferences:</h5>
                    <div class="badge bg-success text-white me-2 mb-2 badge-date">Veg: <strong id="vegCount">0</strong></div>
                    <div class="badge bg-danger text-white badge-date">Non-Veg: <strong id="nonVegCount">0</strong></div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
    
    <script>
        // ============================================
        // FIREBASE CONFIGURATION
        // ============================================
        // IMPORTANT: Replace this with your own Firebase config
        // Get this from: Firebase Console > Project Settings > Your apps > Web app
        
const firebaseConfig = {
  apiKey: "AIzaSyAHQ8i2rc-U-EpL-E87hLcD3rd0y63x6XQ",
  authDomain: "event-registration-2025.firebaseapp.com",
  databaseURL: "https://event-registration-2025-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "event-registration-2025",
  storageBucket: "event-registration-2025.firebasestorage.app",
  messagingSenderId: "950650774844",
  appId: "1:950650774844:web:4491a4e8f555d2be6fea39",
  measurementId: "G-NFXNSNEX5T"
};
        
        // Initialize Firebase
        let database;
        let registrationsRef;
        let isFirebaseConfigured = false;
        
        try {
            // Check if Firebase config is set
            if (firebaseConfig.apiKey !== "YOUR_API_KEY_HERE") {
                firebase.initializeApp(firebaseConfig);
                database = firebase.database();
                registrationsRef = database.ref('registrations');
                isFirebaseConfigured = true;
                console.log('âœ… Firebase initialized successfully');
            } else {
                console.warn('âš ï¸ Firebase not configured. Using localStorage fallback.');
                showConfigInstructions();
            }
        } catch (error) {
            console.error('âŒ Firebase initialization error:', error);
            alert('Firebase connection error. Using local storage fallback.');
        }
        
        // Show configuration instructions if Firebase not set up
        function showConfigInstructions() {
            const banner = document.createElement('div');
            banner.style.cssText = 'position: fixed; top: 0; left: 0; right: 0; background: #ff9800; color: white; padding: 15px; text-align: center; z-index: 9999; font-weight: bold;';
            banner.innerHTML = 'âš ï¸ Firebase Not Configured - Currently using localStorage (data not shared between users). <a href="#setup" style="color: white; text-decoration: underline;" onclick="showFirebaseSetup()">Click here for setup instructions</a>';
            document.body.insertBefore(banner, document.body.firstChild);
        }
        
        // Store registrations
        let registrations = [];
        
        // Check if localStorage is available (fallback)
        function isLocalStorageAvailable() {
            try {
                const test = '__localStorage_test__';
                localStorage.setItem(test, test);
                localStorage.removeItem(test);
                return true;
            } catch(e) {
                return false;
            }
        }
        
        // Load registrations from Firebase or localStorage
        if (isFirebaseConfigured) {
            // Listen for real-time updates from Firebase
            registrationsRef.on('value', (snapshot) => {
                const data = snapshot.val();
                registrations = data ? Object.values(data) : [];
                updateSummary();
                console.log('ğŸ“Š Loaded', registrations.length, 'registrations from Firebase');
            }, (error) => {
                console.error('Error reading from Firebase:', error);
            });
        } else {
            // Fallback to localStorage
            if (isLocalStorageAvailable()) {
                registrations = JSON.parse(localStorage.getItem('eventRegistrations')) || [];
                console.log('ğŸ“Š LocalStorage fallback: Loaded', registrations.length, 'registrations');
            } else {
                console.warn('LocalStorage not available. Data will not persist after page refresh.');
                alert('âš ï¸ Warning: Your browser settings are preventing data storage. Please use a regular browser window (not incognito/private mode).');
            }
        }
        
        // Load existing registrations on page load
        window.addEventListener('DOMContentLoaded', function() {
            if (!isFirebaseConfigured) {
                updateSummary();
            }
            // Show stored count if any
            if (registrations.length > 0) {
                console.log('âœ… Restored', registrations.length, 'registrations');
            }
        });
        
        // Handle form submission
        document.getElementById('registrationForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Get form values
            const registration = {
                name: document.getElementById('name').value,
                mobile: document.getElementById('mobile').value,
                adults: parseInt(document.getElementById('adults').value),
                children: parseInt(document.getElementById('children').value),
                foodPreference: document.getElementById('foodPreference').value,
                eventDate: document.querySelector('input[name="eventDate"]:checked').value,
                timestamp: new Date().toISOString()
            };
            
            // Save to Firebase or localStorage
            if (isFirebaseConfigured) {
                // Save to Firebase
                registrationsRef.push(registration)
                    .then(() => {
                        console.log('âœ… Saved to Firebase successfully');
                        showSuccessMessage();
                        this.reset();
                        document.querySelector('.summary-card').scrollIntoView({ behavior: 'smooth' });
                    })
                    .catch((error) => {
                        console.error('âŒ Firebase save error:', error);
                        alert('Failed to save registration: ' + error.message);
                    });
            } else {
                // Fallback to localStorage
                registrations.push(registration);
                
                if (isLocalStorageAvailable()) {
                    try {
                        localStorage.setItem('eventRegistrations', JSON.stringify(registrations));
                        console.log('âœ… Saved to localStorage. Total:', registrations.length);
                    } catch(e) {
                        console.error('Failed to save to localStorage:', e);
                        alert('âš ï¸ Failed to save registration. Storage might be full.');
                    }
                }
                
                updateSummary();
                showSuccessMessage();
                this.reset();
                document.querySelector('.summary-card').scrollIntoView({ behavior: 'smooth' });
            }
        });
        
        // Show success message
        function showSuccessMessage() {
            const successMessage = document.getElementById('successMessage');
            successMessage.style.display = 'block';
            setTimeout(() => {
                successMessage.style.display = 'none';
            }, 3000);
        }
        
        function updateSummary() {
            // Calculate totals
            const totalRegistrations = registrations.length;
            const totalAdults = registrations.reduce((sum, reg) => sum + reg.adults, 0);
            const totalChildren = registrations.reduce((sum, reg) => sum + reg.children, 0);
            const totalPeople = totalAdults + totalChildren;
            
            // Count date preferences
            const date1Count = registrations.filter(reg => reg.eventDate === '28-Dec-2025').length;
            const date2Count = registrations.filter(reg => reg.eventDate === '4-Jan-2026').length;
            
            // Count food preferences
            const vegCount = registrations.filter(reg => reg.foodPreference === 'Veg').length;
            const nonVegCount = registrations.filter(reg => reg.foodPreference === 'Non-Veg').length;
            
            // Update stats
            document.getElementById('totalRegistrations').textContent = totalRegistrations;
            document.getElementById('totalAdults').textContent = totalAdults;
            document.getElementById('totalChildren').textContent = totalChildren;
            document.getElementById('totalPeople').textContent = totalPeople;
            document.getElementById('date1Count').textContent = date1Count;
            document.getElementById('date2Count').textContent = date2Count;
            document.getElementById('vegCount').textContent = vegCount;
            document.getElementById('nonVegCount').textContent = nonVegCount;
            
            // Update table
            const tableBody = document.getElementById('registrationsTableBody');
            
            if (registrations.length === 0) {
                tableBody.innerHTML = `
                    <tr>
                        <td colspan="7" class="no-registrations">
                            No registrations yet. Be the first to register!
                        </td>
                    </tr>
                `;
            } else {
                tableBody.innerHTML = registrations.map((reg, index) => `
                    <tr>
                        <td>${index + 1}</td>
                        <td>${reg.name}</td>
                        <td>${reg.mobile}</td>
                        <td>${reg.adults}</td>
                        <td>${reg.children}</td>
                        <td><span class="badge ${reg.foodPreference === 'Veg' ? 'bg-success' : 'bg-danger'}">${reg.foodPreference}</span></td>
                        <td><span class="badge ${reg.eventDate === '28-Dec-2025' ? 'bg-info text-dark' : 'bg-success'}">${reg.eventDate}</span></td>
                    </tr>
                `).join('');
            }
        }
        
        // Export data to JSON file
        function exportData() {
            if (registrations.length === 0) {
                alert('No registrations to export!');
                return;
            }
            
            const dataStr = JSON.stringify(registrations, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'event-registrations-' + new Date().toISOString().split('T')[0] + '.json';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
            
            alert('âœ… Data exported successfully!');
        }
        
        // Import data from JSON file
        function importData(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const importedData = JSON.parse(e.target.result);
                    if (!Array.isArray(importedData)) {
                        throw new Error('Invalid data format');
                    }
                    
                    if (isFirebaseConfigured) {
                        // Import to Firebase
                        importedData.forEach(reg => {
                            registrationsRef.push(reg);
                        });
                        alert('âœ… Data imported to Firebase! Added ' + importedData.length + ' registrations.');
                    } else {
                        // Merge with existing data (avoid duplicates based on mobile + name)
                        importedData.forEach(newReg => {
                            const exists = registrations.some(reg => 
                                reg.mobile === newReg.mobile && reg.name === newReg.name
                            );
                            if (!exists) {
                                registrations.push(newReg);
                            }
                        });
                        
                        // Save to localStorage
                        if (isLocalStorageAvailable()) {
                            localStorage.setItem('eventRegistrations', JSON.stringify(registrations));
                        }
                        
                        updateSummary();
                        alert('âœ… Data imported successfully! Added ' + importedData.length + ' registrations.');
                    }
                } catch (error) {
                    alert('âŒ Error importing data: ' + error.message);
                }
            };
            reader.readAsText(file);
            
            // Reset input
            event.target.value = '';
        }
        
        // Show Firebase setup instructions
        function showFirebaseSetup() {
            const instructions = `
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ”¥ FIREBASE SETUP INSTRUCTIONS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

STEP 1: Create a Firebase Project
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1. Go to: https://console.firebase.google.com/
2. Click "Add project" or "Create a project"
3. Enter project name (e.g., "event-registration")
4. Disable Google Analytics (optional)
5. Click "Create project"

STEP 2: Enable Realtime Database
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1. In Firebase Console, click "Realtime Database" in left menu
2. Click "Create Database"
3. Choose location (closest to your users)
4. Start in "Test mode" (for now) - Click "Enable"
   
   âš ï¸ IMPORTANT: Test mode allows anyone to read/write
   For production, set these rules:
   
   {
     "rules": {
       "registrations": {
         ".read": true,
         ".write": true
       }
     }
   }

STEP 3: Get Your Firebase Config
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1. Click the gear icon âš™ï¸ next to "Project Overview"
2. Click "Project settings"
3. Scroll down to "Your apps"
4. Click the "</>" (Web) icon
5. Register app (give it a name, e.g., "event-form")
6. Copy the firebaseConfig object

STEP 4: Update This HTML File
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1. Open this HTML file in a text editor
2. Find this section (around line 340):

   const firebaseConfig = {
       apiKey: "YOUR_API_KEY_HERE",
       authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
       ...
   };

3. Replace it with YOUR config from Firebase Console
4. Save the file

STEP 5: Test It!
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1. Open the HTML file in your browser
2. The orange warning banner should disappear
3. Register a test entry
4. Open the page in another browser/device
5. You should see the same data! ğŸ‰

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Need help? Check the browser console (F12) for errors.
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            `;
            
            alert(instructions);
            console.log(instructions);
        }
    </script>
</body>
</html>
